<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simulatore Forfettario – GS 2025</title>
<style>
  body{font-family:Arial, sans-serif; background:#f9fafb; margin:0; color:#111;}
  .container{max-width:700px; margin:40px auto; background:#fff; padding:24px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
  h1{margin-top:0;}
  label{display:block; margin-top:12px; font-weight:600;}
  input, select{width:100%; padding:10px; margin-top:4px; border:1px solid #ddd; border-radius:8px;}
  button{margin-top:20px; padding:12px 20px; background:#2563eb; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:16px;}
  button:hover{background:#1d4ed8;}
  .hidden{display:none;}
  .results{margin-top:24px; padding:20px; background:#f3f4f6; border-radius:12px;}
  .kpi{margin:10px 0; font-weight:bold;}
  .explanation{margin-top:20px; line-height:1.6;}
</style>
</head>
<body>
<div class="container">
  <h1>Simulatore Regime Forfettario – GS 2025</h1>

  <!-- Input -->
  <div id="inputs">
    <label>Incassato annuo (€)</label>
    <input id="incassato" type="number" min="0" step="0.01" placeholder="Es. 45000" />

    <label>Coefficiente di redditività</label>
    <select id="coeff">
      <option value="0.78">78%</option>
      <option value="0.86">86%</option>
      <option value="0.67">67%</option>
    </select>

    <label>Imposta sostitutiva</label>
    <select id="imposta">
      <option value="0.05">5% (Startup)</option>
      <option value="0.15">15% (Ordinaria)</option>
    </select>

    <label>Contributi previdenziali già versati (€)</label>
    <input id="deducibili" type="number" min="0" step="0.01" value="0" />

    <label>Acconti imposta versati l’anno prima (€)</label>
    <input id="accImpostaVersati" type="number" min="0" step="0.01" value="0" />

    <label>Acconti INPS GS versati l’anno prima (€)</label>
    <input id="accInpsVersati" type="number" min="0" step="0.01" value="0" />

    <button id="btnCalc">CALCOLA</button>
  </div>

  <!-- Risultati -->
  <div id="results" class="results hidden">
    <h2>Risultati</h2>
    <div class="kpi">Reddito imponibile forfettario: <span id="outImponibile"></span></div>
    <div class="kpi">Contributi INPS dovuti: <span id="outInps"></span></div>
    <div class="kpi">Imposta sostitutiva: <span id="outImposta"></span></div>
    <div class="kpi">Saldo da pagare ora: <span id="outSaldo"></span></div>
    <div class="kpi">Acconti per l’anno prossimo: <span id="outAcconti"></span></div>
    <div class="kpi">Totale da versare: <span id="outTotale"></span></div>

    <div class="explanation" id="explanation"></div>
  </div>
</div>

<script>
  const € = n => new Intl.NumberFormat('it-IT',{style:'currency',currency:'EUR'}).format(n||0);

  document.getElementById("btnCalc").addEventListener("click", ()=>{
    const incassato = parseFloat(document.getElementById("incassato").value)||0;
    const coeff = parseFloat(document.getElementById("coeff").value);
    const impostaRate = parseFloat(document.getElementById("imposta").value);
    const deducibili = parseFloat(document.getElementById("deducibili").value)||0;
    const accImpVersati = parseFloat(document.getElementById("accImpostaVersati").value)||0;
    const accInpsVersati = parseFloat(document.getElementById("accInpsVersati").value)||0;

    const ALIQUOTA_INPS = 0.2607;
    const ACCONTO_INPS_PERC = 0.80;

    const imponibileForf = incassato * coeff;
    const inps = imponibileForf * ALIQUOTA_INPS;
    const imponibileFiscale = Math.max(0, imponibileForf - deducibili);
    const imposta = imponibileFiscale * impostaRate;

    const saldoImposta = Math.max(0, imposta - accImpVersati);
    const saldoInps = Math.max(0, inps - accInpsVersati);
    const saldoTotale = saldoImposta + saldoInps;

    const accImpostaTot = imposta;
    const accInpsTot = inps * ACCONTO_INPS_PERC;
    const accontiTotali = accImpostaTot + accInpsTot;

    const totale = saldoTotale + accontiTotali;

    // Output numerico
    document.getElementById("outImponibile").textContent = €(imponibileForf);
    document.getElementById("outInps").textContent = €(inps);
    document.getElementById("outImposta").textContent = €(imposta);
    document.getElementById("outSaldo").textContent = €(saldoTotale);
    document.getElementById("outAcconti").textContent = €(accontiTotali);
    document.getElementById("outTotale").textContent = €(totale);

    // Spiegazione personalizzata
    let spiegazione = `
      Hai indicato che nell’anno hai incassato <b>${€(incassato)}</b>.
      Con il coefficiente di redditività scelto (${Math.round(coeff*100)}%) il fisco considera solo una parte come “guadagno”.
      Su questo calcoliamo i <b>contributi INPS</b> con l’aliquota del 26,07%.
      Per l’imposta sostitutiva hai scelto l’aliquota del <b>${Math.round(impostaRate*100)}%</b>, 
      che si applica dopo aver tolto eventuali contributi già versati (<b>${€(deducibili)}</b>).
      Guardando agli acconti: l’anno scorso hai già versato <b>${€(accImpVersati)}</b> di imposta e <b>${€(accInpsVersati)}</b> di INPS.
      Quindi il tuo <b>saldo adesso</b> è quello che rimane dopo aver tolto quegli acconti.
      In più versi <b>acconti per l’anno prossimo</b> (imposta al 100%, INPS all’80%) così l’anno dopo pagherai meno.
      Alla fine, quello che devi pagare adesso è la somma del saldo e degli acconti.
    `;
    document.getElementById("explanation").innerHTML = spiegazione;

    // Mostra risultati
    document.getElementById("results").classList.remove("hidden");
    window.scrollTo({top: document.getElementById("results").offsetTop, behavior:'smooth'});
  });
</script>
</body>
</html>
